// Generated by CoffeeScript 1.10.0
var makePath;

socket.on('load canvas', function(data) {
  console.log(data);
  $('#connected').text(data.num_users);
  return canvas.loadFromJSON(data.canvas_state);
});

socket.on('user connected', function(data) {
  return $('#connected').text(data.total);
});

socket.on('user disconnected', function(data) {
  return $('#connected').text(data.total);
});

socket.on('add path', function(json_path) {
  var p;
  p = makePath(json_path);
  return canvas.add(p);
});

socket.on('remove path', function(json_path) {
  var p;
  p = makePath(json_path);
  return canvas.forEachObject(function(obj) {
    var obj_path, p_path;
    obj_path = obj.path.toString();
    p_path = p.path.toString();
    if (obj_path === p_path) {
      return obj.remove();
    }
  });
});

makePath = function(json_path) {
  var path, svg_d;
  svg_d = json_path.path.toString().split(',').join(' ');
  path = new fabric.Path(svg_d, {
    stroke: json_path.stroke,
    strokeWidth: json_path.strokeWidth,
    fill: null,
    strokeLineCap: 'round',
    strokeLineJoin: 'round',
    pathOffset: {
      x: json_path.pathOffset.x,
      y: json_path.pathOffset.y
    }
  });
  return path;
};
