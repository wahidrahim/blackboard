// Generated by CoffeeScript 1.10.0
var actions, canvas, socket;

socket = io();

canvas = new fabric.Canvas('canvas', {
  backgroundColor: '#222',
  width: 1152,
  height: 720,
  isDrawingMode: true
});

actions = [];

actions.last = function() {
  return this[this.length - 1];
};

canvas.on('path:created', function(e) {
  actions.push(e.path);
  socket.emit('add path', e.path.toJSON());
  return socket.emit('save canvas', canvas.toJSON());
});

$('#undo').click(function(e) {
  canvas.remove(actions.last());
  return actions.pop();
});

$('#color').change(function(e) {
  var val;
  val = $('#color').val();
  canvas.freeDrawingBrush.color = val;
  return $('#brush-style').css({
    'background': val
  });
});

$('#width').on('input', function(e) {
  var val;
  val = $('#width').val();
  canvas.freeDrawingBrush.width = val;
  $('#widthField').val(val);
  return $('#brush-style').css({
    'height': val,
    'width': val
  });
});

$('#color').change();

$('#width').trigger('input');
